---
title: "Mystery Data 3"
author: "Webb"
date: "4/3/2018"
output:
 word_document:
   reference_docx: manuscriptstyle.docx
---

```{r setup, include=FALSE, echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
```

##Overall Precipitation in Colorado

From 1948 to 2012 there is a general trend of mean precipitation by month to increase dramatically between August and September, and to slowly decrease through the winter months (Figure 1). There is a steady increase in the amount of mean precipitation as the spring progresses (March, April and May), but the monthly trend over 64 years indicates a spike in rainfall near the end of summer. 
  

```{r precip, echo=FALSE, message=FALSE, warning=FALSE}
precip <- read.csv("rain_co.csv")
library(plotrix)
library(doBy)
library(lubridate)
library(magicaxis)
library(sciplot)
library(scales)
precip$month <- month(precip$DateTime)
precip$year <- year(precip$DateTime)
precip$thirteen <- as.factor(ifelse(precip$year %in% 
                            c("2012", "2013"), "drought", "non-drought"))
rain_agg <- summaryBy(HPCP ~ month, data=precip,FUN = mean, na.rm=TRUE)
plot(HPCP.mean ~ month, data=rain_agg, type='l', 
     xlab="Month", ylab="Mean Precipitation from 1948-2012 (mm)", pch=18, col="navy",
     xaxt='n')
magaxis(side=1, majorn=13, labels=TRUE, minorn=0)

```

  
Figure 1: The Mean precipitation levels (mm) by month from the year 1948 to 2012. 
  
  
##Precipitation Patterns Leading to September 2013 

In 2013 there was a large spike in precipitation corresponding to the flood in September (Figure 2). There is also a small increase in precipitation around July and August. When compared to the annual trend in Colorado, these small spikes in precipitation amounts near the end of the summer are fairly common (Figure 1). There is a very steady, low amount of precipitation through the winter and spring which does not coincide with the steady increase in precipitation seen on a 64 year scale (Figure 1). 

```{r short_term, echo=FALSE, message=FALSE, warning=FALSE}
precip$year <- year(precip$DateTime)
short_term <- precip[14151:14476,]
short_term <- read.csv("short_term_rain.csv")
short_term$month <- month(short_term$DateTime)
short_term$year <- as.factor(year(short_term$DateTime))
navy <- "navy"
red <- "red"
navy1<-alpha(navy, 0.5)
red1<-alpha(red, 0.5)
plot(HPCP ~ jitter(month,0.4), data=short_term[short_term$year==2013,],
     pch=18, col=navy1, xlab="Month", ylab="Precipitation (mm)",xaxt='n')
magaxis(side=1, majorn=13, minorn=0, labels=TRUE)
points(HPCP ~ month, data=short_term[short_term$year==2012,],
     pch=20, col=red1)
```

  
  Figure 2: Precipitation measures (mm) taken during each month of 2013. Darker areas indicate locations where levels of water were similar. 
  
    
##Colorado Drought History 
 The years leading up the severe flood in 2013 are marked by fairly dry years. When the Palmer Drought Severity Index is around -3 or -4, it indicates a severe drought. The overall average PDSI is also somewhat low for 2013, the year of the flood, considering the severity of water inflow. It seems as though the flood occurred in a period of a few years where severe drought occurred (Figure 3). 
 
```{r drought trends, echo=FALSE, message=FALSE, warning=FALSE}
climate<-read.csv("climate_co.csv")
climate$month <- month(climate$date)
climate$year <- year(climate$date)
drought_agg <- summaryBy(PDSI ~ month, data=climate, FUN=mean, na.rm=TRUE)
drought_annual <- summaryBy(PDSI ~ year, data=climate, FUN=mean, na.rm=TRUE)
plot(PDSI.mean ~ year, data=drought_annual, type='l',
     xlab="Year", ylab="Mean PDSI from 1991-2016", pch=18, col="navy", xaxt='n')
magaxis(side=1,majorn=6,labels=TRUE)
```
 
Figure 3: Mean annual Palmer Drought Severity Index (PDSI) from 1991 to 2016.  


  
##Palmer Drought Severity Index Trends

###PDSI and Precipitation 
  PDSI varies with levels of temperature and precipitation. There is a positive correlation between average precipitation and PDSI measures (Figure 4). The year of the flood is characterized by a low average in precipitation and considered and overall dry year indicating that the flood was not coinciding with the dry trend of the year. 
```{r PDSI, echo=FALSE, warning=FALSE, message=FALSE}
climate<-read.csv("climate_co.csv")
two_factor<- c("red", "navy")
climate$year <- (year(climate$date))
climate$month <-(month(climate$date))
climate$drought <- as.factor(ifelse(climate$year %in% "2013", "drought", "other"))
PDSI_avg <- summaryBy(PDSI ~ year, data=climate, FUN=mean,na.rm=TRUE)
pcp_avg <- summaryBy(PCP ~ year, data=climate, FUN=mean, na.rm=TRUE)
pcp<-pcp_avg$PCP.mean
PDSI_avg$pcp<-pcp
plot(PDSI.mean ~ pcp, data=PDSI_avg,
     col="navy", pch=18, ylab="Mean PDSI", xlab="Mean Precipitation (mm)",
     ylim=c(-5,5))
points(PDSI.mean ~ pcp, data=PDSI_avg[PDSI_avg$year==2013,], pch=5, col="red")
```

Figure 4: Palmer Drought Severity Index (PDSI) variations relating to precipitation levels. Means are taken from monthly readings from 1991 to 2016. The point highlighted in red indicates the year of the flood in Colorado, 2013. 
  
### PDSI and Temperature 
  The positive correlation between average precipitation and drought is intuitive, but there does not appear to be the same relationship between average temperature and PDSI. With measures from 25 years there is no obvious correlation between temperature and drought (Figure 5). It is possible that droughts in Colorado are not severely affected by temperature, although the lowest average temperature does coincide with the lowest drought index. It is likely that temperature is an exacerbating quality to drought, but is not likely a causal property in Colorado. 
```{r PDSIT, echo=FALSE, warning=FALSE, message=FALSE}
temp_avg <- summaryBy(TAVG~ year, data=climate, FUN=mean, na.rm=TRUE)
PDSI_avg <- summaryBy(PDSI ~ year, data=climate, FUN=mean,na.rm=TRUE)
temp<-temp_avg$TAVG.mean
PDSI_avg$temp<-temp
plot(PDSI.mean ~ temp, data=PDSI_avg,
     xlab="Mean Temperature (F)", ylab="Mean PDSI", col="navy", pch=18,
     ylim=c(-5, 5), xlim=c(48,53))
points(PDSI.mean ~ temp, data=PDSI_avg[PDSI_avg$year==2013,], col="red", pch=5)

```
  
    
Figure 5: Palmer Drought Severity Index (PDSI) variations relating to temperature in Colorado. Means are taken from monthly readings from 1991 to 2016. The point highlighted in red indicates the year of the flood in Colorado, 2013. 



  
##Discharge Impact of Flood
  
There is a very apparent increase in the water discharge amount that coincides with the time of the flood in September of 2013 (Figure 5). This increase is preceded by a few months at the beginning of the year where the discharge amount was close to zero, showing a lack of precipitation that was also seen in analyzing the months leading up to the flood (Figures 2 & 3). October was also characterized by a larger discharge value than earlier months, but the amount receded fairly quickly, returning to low levels of discharge by November. 
```{r discharge, echo=FALSE, warning=FALSE, message=FALSE}
discharge <- read.csv("discharge_co.csv")
blue<-"navy"
light_navy<- alpha(blue, 0.5)
discharge$month <- (month(discharge$date))
discharge$year <- as.factor(year(discharge$date))
plot(disval_m ~ month, data=discharge[discharge$year==2013,], ylim=c(0,60),
     col=light_navy, ylab="Water Discharge (m)",xlab="Month", xaxt='n')
magaxis(side=1, majorn=13, minorn=0, labels=TRUE)

```

Figure 6: Water discharge amounts (m) by month in 2013. 