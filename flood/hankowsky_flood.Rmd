---
title: "2013 Boulder Colorado Flooding Event a Combination of Extreme Preciptiation Event and Intense Drought Severity "
author: "Keith Hankowsky"
date: "April 3rd, 2018"
output: 
  word_document:
   reference_docx: manuscriptstyle.docx
---

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(lubridate)
```

##Figures

```{r precip total, echo=FALSE, fig.width=6}
precip <- read.csv("data/805333-precip_daily_1948-2013.csv")

precip$DateTime <- as.POSIXct(precip$DATE, format= "%Y%m%d %H:%M")
precip$HPCP[precip$HPCP==999.99] <- NA
precip1 <- droplevels(precip[complete.cases(precip$HPCP), ])

seqraindates <- seq(min(precip1$DateTime), max(precip1$DateTime), length.out=10)

par(mar=c(5,5,1,1))
plot(HPCP ~ DateTime, data=precip1, type="l", axes=FALSE, xlab="Year",
     ylab="Precipitation (mm)")
axis.POSIXct(1, at=seqraindates, cex.axis=0.9)
axis(2, las=2, cex.axis=0.9)
box()
```

**Figure 1.** Precipitation (mm) in Boulder, CO from 1948 to 2013. 

```{r precip 2010, echo=FALSE, fig.width=6}
startdate <- as.POSIXct("2010-01-01 01:00:00", "%Y-%m-%d %H:%M:%S", tz="UTC")
newrain <- precip1[precip1$DateTime > startdate,]
plot(HPCP ~ DateTime, data=newrain, type="l", xlab="Year", ylab="Precipitation (mm)")
```

**Figure 2.** Precipitation (mm) in Boulder, CO from 2010 to 2013. 

```{r precip month, echo=FALSE, fig.width=6}
precip1$month <- month(precip1$DateTime)

se <- function(x) sd(x)/sqrt(length(x))
rain_agg <- doBy::summaryBy(HPCP ~ month, data=precip1, FUN=c(mean,se))
monthaxis <- c("Jan", "Feb", "Mar", "Apr", "May", "June", "July", "Aug", "Sept", 
               "Oct", "Nov", "Dec")

plot(HPCP.mean ~ month, data=rain_agg, type="b", ylim=c(0.04,0.12), 
     ylab="Precipitation (mm)", xlab="", axes=FALSE)
with(rain_agg, arrows(month, HPCP.mean, month, HPCP.mean+HPCP.se, angle=90, 
                      length=0.03))
with(rain_agg, arrows(month, HPCP.mean, month, HPCP.mean-HPCP.se, angle=90, 
                      length=0.03))
axis(1, at=1:12, labels=monthaxis, las=3)
axis(2, las=2, cex.axis=0.8)
box()
```

**Figure 3.** Monthly variation in mean precipitation (mm) SE in Boulder, CO.

```{r discharge total, echo=FALSE, fig.width=6}
discharge <- read.csv("data/06730200-Discharge_Daily_1986-2013.csv")

discharge$disCorrect <- discharge$disValue*0.0283168
discharge$Date <- as.Date(discharge$datetime, format= "%m/%d/%y")
dislab=expression(Stream~Discharge~~(m^3~s^-1))

seqdisdates <- seq(min(discharge$Date), max(discharge$Date), length.out=10)

par(mar=c(5,5,1,1))
plot(disCorrect~Date, data=discharge, type="l", axes=FALSE, xlab="Year",  ylab=dislab)
axis.Date(1, at=seqdisdates, cex.axis=0.9)
axis(2, las=2, cex.axis=0.9)
box()
```

**Figure 4.** Stream discharge (m^3^ s^-1^) in Boulder, CO from 1986 to 2013. 

```{r discharge 2013, echo=FALSE, fig.width=6}
startdate_discharge <- as.POSIXct("2013-01-01 01:00:00", "%Y-%m-%d %H:%M:%S", tz="UTC")
newdischarge <- discharge[discharge$Date > startdate_discharge,]

par(mar=c(5,5,1,1))
plot(disCorrect~Date, data=newdischarge, type="l", ylab=dislab, xlab="", las=2)
```

**Figure 5.** Stream discharge (m^3^ s^-1^) in Boulder, CO in 2013. 

```{r drought, echo=FALSE, fig.width=6}
drought <- read.table("data/climate_co.txt", header = TRUE)

drought$YearMonthDay <- paste(drought$YearMonth, "01", sep="")
drought$Date <- as.Date(drought$YearMonthDay, format="%Y%m%d")

seqdrodates <- seq(min(drought$Date), max(drought$Date), length.out=10)

plot(PDSI ~ Date, data=drought, type="l", axes=FALSE, xlab="Year", 
     ylab="Palmer Drought Serverity Index")
axis.Date(1, at=seqdrodates, cex.axis=0.9)
axis(2, las=2, cex.axis=0.9)
abline(v=2013-01-01, col="red", lty=2, lwd=3)
box()
```

**Figure 6.** Palmer Drought Severity Index (PSDI) for Boulder, CO from 1991 to 2016. PSDI is a hydrological drought index used to assess long-term moisture supply. Negative values in the index denote dry spells, and positive values indicate wet spells. Values exceeding -2 indicate moderate drought and greater than -4 indicate extreme drought. Similar adjectives are attached to positive values of wet spells.


##Discussion 
  In September 2013, a devastating flood hit Boulder County, Colorado. The storm was a culmination of a slow moving cold front which interacted with a warm humid front resulting in heavy rain and destructive flooding. In order to understand why this 1 in 1000 year flood occurred, the precipitation, stream gauge outflow and drought data for the watershed where the flood occurred will be investigated. 
  The 2013 flood saw some of the highest precipitation values since the 1950s (Fig 1). Since the 1950s, there have only been five other precipitation events that have reached the same magnitude of the 2013 flood. However, since 2000 there has not been a precipitation event that has reached the magnitude of the 2013 event (Fig 2). Historically, the most precipitation occurs during the summer months of July and August (Fig 3). However, this flooding event occurred in September, which could help explain why the community was unprepared for the event, because they expect most of the precipitation to occur during the summer months. 
  The 2013 flood saw the largest stream discharge (m^3^ s^-1^) since 1986 (Fig 4). However, the last significant precipitation event occurred in 1983 but stream discharge data did not date back to then. It would be useful to know the stream discharge during a substantial precipitation event. The September 2013 event was an order of magnitude larger than the stream discharge at any other point throughout 2013 (Fig 5). 
  The Palmer Drought Severity Index (PSDI) is a hydrological drought index used to assess long-term moisture supply. Negative values in the index denote dry spells, and positive values indicate wet spells. Leading up to the 2013 flooding event, the PSDI had the lowest values since 1991 (Fig 6). In 2002, the PSDI was very low as well, but there was not a significant precipitation event. The combination of extreme drought and significant precipitation event is likely the cause of the devastating flooding in Boulder, CO.  