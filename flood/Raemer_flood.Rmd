---
title: 'Precipitation, drought, and temperature in Boulder, CO leading up to September 2013 flooding event'
author: "Ashlea Raemer"
date: "April 4, 2018"
output: 
  word_document:
    reference_docx: manuscriptstyle.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Analysis

In Boulder, Colorado the average hourly precipitation is highest during the summer months of July and August (Figure 1). During 2013, there was a major spike in precipitation in the month of September (Figure 2), well above the observed average precipitation during the average year (Figure 1). Precipitation in September 2013 was also greater than the average precipitation during peak months (Figure2; Figure 1). On average, the Palmer Drought Severity Index (PDSI) value reaches is the highest positive value (indicating the wettest conditions) in August (Figure 3). In 2013 the PDSI values for each month were in the negative, indicating drought conditions (Figure 4). Between August 2013 and September 2013 there was a large increase towards less negative PDSI (Figure 4), consistent with the observed spike in precipitation (Figure 2). The abnormal drought-like conditions leading up to the spike in precipitation in September 2013 together indicate that the flooding was caused by a wave of precipitation hitting ground that was too dry to absorb all the water. The average annual temperature in Boulder spiked in 2012 and hit an abnormal low in 2013 (Figure 5). The warm conditions in 2012 could be a potential contributer to the abnormal drought conditions experienced in 2013 (Figure 4). The drought-like conditions (Figure 4), followed by a spike in precipitation in September 2013 (Figure 2) are both consistent with observations of stream discharge in 2013 which are consistently low with a large spike in September (Figure 6). 

```{r cars, echo=FALSE, message=FALSE, warning=FALSE}
library(lubridate)
library(doBy)
library(sciplot)
se <- function(x) sd(x)/sqrt(length(x))
dislab <- expression(Stream~Discharge~~(m^3~s^-1))
rain <- read.csv ("../flood/data/rain_co.csv")
rain$DateTime <- as.POSIXct(rain$DATE, format= "%Y%m%d %H:%M")
rain$month <- month(rain$DateTime)
newrain <- rain[complete.cases(rain$HPCP),]
discharge <- read.csv("../flood/data/discharge_co.csv")
discharge$Date <- as.Date(discharge$datetime, format="%m/%d/%y")
drought <- read.csv("../flood/data/climate_co.csv")
drought$Date <- paste(drought$YearMonth, "01", sep="")
drought$Date <- as.Date(drought$Date, format="%Y%m%d")
rain$month <- month(rain$DateTime)
newrain <- rain[complete.cases(rain$HPCP),]
rain_agg <- summaryBy(HPCP ~ month, data=newrain,FUN=c(mean,se))
newrain$year <- year(newrain$DateTime)
rain_agg2 <- summaryBy(HPCP ~ year, data=newrain, FUN=c(mean,se))
rain_2013 <- subset(newrain, year == 2013, select= c(HPCP, DateTime, month))
rain_2013_agg <- summaryBy(HPCP ~ month, data=rain_2013,FUN=c(mean,se))
drought$month <- month(drought$Date)
drought_agg <- summaryBy(PDSI ~ month, data=drought,FUN=c(mean,se))
drought$year <- year(drought$Date)
drought_2013 <- subset(drought, year == 2013, select= c(PDSI, TAVG, Date, month))
drought_2013_agg <- summaryBy(PDSI ~ month, data=drought_2013,FUN=c(mean,se))
drought_temp_agg <- summaryBy(TAVG ~ year, data=drought,FUN=c(mean,se))
discharge$month <- month(discharge$Date)
discharge$year <- year(discharge$Date)
discharge_2013 <- subset(discharge, year == 2013, select= c(disValue, disMeter, Date, month))
discharge_2013_agg <- summaryBy(disMeter ~ month, data=discharge_2013,FUN=c(mean,se))
```
```{r pressure, echo=FALSE, message=FALSE, warning=FALSE}
par(mar=c(5,5,1,1))
plot(HPCP.mean ~ month, data=rain_agg, type="b", xlab="Month", ylab="Average Hourly Precipitation (mm)", bty="l", pch=21, bg="black")
```

Figure 1. Average hourly precipitation (mm) by month in Boulder, CO. 


```{r, echo=FALSE, message=FALSE, warning=FALSE}
plot(HPCP.mean ~ month, data=rain_2013_agg, type="b", xlab="Month", ylab="Average Hourly Precipitation (mm)", bty="l", pch=21, bg=ifelse(month==9, "red", "black"))
```

Figure 2. Average hourly precipitation (mm) by month in Boulder, CO for the year 2013. Red data point indicates average precipitation in the month of September. 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
par(mar=c(5,5,1,1))
plot(PDSI.mean ~ month, data=drought_agg, type="b", xlab="Month", ylab="Average PDSI Index", bty="l", pch=21, bg="black")
```

Figure 3. Average PDSI index value by month in Boulder, CO. 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
plot(PDSI.mean ~ month, data=drought_2013_agg, type="b", xlab="Month", ylab="Average PDSI Index", bty="l", pch=21, bg=ifelse(month==9, "red", "black"))
```

Figure 4. Average PDSI index value by month in Boulder, CO in 2013. Red data point indicates average PDSI index value for September 2013. 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
plot(TAVG.mean ~ year, data=drought_temp_agg, type="b", xlab="Year", ylab= "Average Temperature (Fahrenheit)", bty="l", pch=21, bg=ifelse(year==2013, "red", "black"))
```

Figure 5. Average temperature (in degrees Fahrenheit) by year. Red data point represents the year 2013. 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
plot(disMeter.mean ~ month, data=discharge_2013_agg, type="b", xlab="Month", ylab=dislab, bty="l", pch=21, bg=ifelse(month==9, "red", "black"))
```

Figure 6. Stream Discharge (m^3 s^-1) by month in the year 2013. Red data point indicates the year 2013. 
