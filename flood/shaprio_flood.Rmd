
---
output: 
  word_document:
    reference_docx: manuscriptstyle.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Colorado Flood: The Big One  
Shana Shapiro    
April 3, 2018 
\
The Colorado Flood of 2013 was a 1 in 1000 year event. There were severe impacts on the area, and many people had to evacuate. When this level of flooding occurs, it can overwhelm ecosystems as well as impact human lives and economics. This report investigates various factors that contributed to this extreme flood, including precipitation values, drought values, and other climate variables. 
\
\

**Monthly Aggregate Precipitation Levels**
\
Figure 1 shows the aggregate rainfall in the Colorado Basin by month. From 1948 up to 2013, total rainfall sharply increases throughout the year and reaches a peak around August. If the pattern of increased rainfall occurred in 2013, it could explain why the flooding event occurred in the early Autumn. Rainfall, on average, peaked around Autumn and would influence the timing of an extreme flooding event. 
\
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}
library(lubridate)
library(doBy)
library(sciplot)
library(ggplot2)
library(ggExtra)

rain <- read.csv("data/805333-precip_daily_1948-2013.csv")
discharge <- read.csv("data/06730200-Discharge_Daily_1986-2013.csv")

rain$DateTime <- as.POSIXct(rain$DATE, format="%Y%m%d %H:%M")
rain$DATE2 <- as.Date(rain$DATE, "%Y%m%d %H:%M")
rain$month <- month(rain$DateTime)
rain$year <- year(rain$DateTime)
rain2 <- rain[rain$HPCP != 999.99,]

se <- function(x) sd(x)/sqrt(length(x))

rain_agg <- summaryBy(HPCP ~ month, data=rain2, FUN=c(mean, se))
rain_agg$ylo <- rain_agg$HPCP.mean - rain_agg$HPCP.se
rain_agg$yhi <- rain_agg$HPCP.mean + rain_agg$HPCP.se

ggplot(data=rain_agg, aes(x=month, y=HPCP.mean, ymin=ylo, ymax=yhi)) + 
  geom_line(color = 'aquamarine4') +
  xlab("Month of Year") +
  ylab("Precipitation (mm)") +
  xlim(c(0,15)) +
  ylim(c(0.045,0.125)) +
  scale_x_continuous(breaks=c(1:12), 
                     labels=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec")) +
  theme(panel.background = element_rect())


```
**Figure 1. Aggregate rainfall 1948-2013 by month shows a peak in late Summer.**  
\
\

**Yearly Aggregate Precipitation Levels** 
\
Figure 2 investigates another pattern of precipitation leading up to The Big One. Figure 2 shows the total yearly precipitation level for the Colorado Basin. In the period of 1950-1965, there is quite little rainfall for the area. Rainfall dramatically increases between 1965-1975, which may be explained by a variety of climate patterns. Rainfall increases and decreases throughout the years, but remains quite high throughout the 1980s. After 2010, yearly rainfal makes another dramatic jump. These overall increases in yearly rainfall could make an extreme flooding event more likely. Yearly rainfall may increase faster than the existing infrastructure and ecosystems can adapt to, which can have catastrophic human events. The spike in yearly rainfall leading up to 2013 could contribute to the "rare" and extreme flooding event in 2013. 
\
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}
rain_agg2 <- summaryBy(HPCP ~ year, data=rain2, FUN=c(mean, se))
rain_agg2$ylo <- rain_agg2$HPCP.mean - rain_agg2$HPCP.se
rain_agg2$yhi <- rain_agg2$HPCP.mean + rain_agg2$HPCP.se

ggplot(data=rain_agg2, aes(x=year, y=HPCP.mean, ymin=ylo, ymax=yhi)) + 
  geom_line(color = 'chartreuse4') +
  xlab("Date (Year)") +
  ylab("Precipitation (mm)") +
  theme(panel.background = element_rect())
```
**Figure 2. Yearly aggregate rainfall for the Colorado basin 1948-2013.** 
\
\

**PDSI Before The Big One**
\
Figure 3 investigates the severity of the 2013 flood with respect to the Palmer Drought Severity Index before the time of the flood. Figure 3 shows how in the three years leading up to the flood, the overall PDSI was nearly always negative. A negative PDSI rating denotes drought, and the closer the rating is to -6 the more severe the drought episode. There was a consistently negative PDSI rating from Summer 2010 onward, with particularly severe droughts throughout 2012 until the flooding episode in 2013. While drought causes a variety of issues, it can also impact the area's response to flooding. In a drought stricken area, the earth is unable to absorb large quantities of water right away. The effects of a long-term drought could exacerbate the flood effects when The Big One hit in September 2013. 
\
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}
climate_co <- read.csv("data/climate_co.csv")

climate_co2 <- climate_co[complete.cases(climate_co$PDSI),]
climate_co2$month <- month(climate_co2$Date)
climate_co2$year <- year(climate_co2$Date)
climate_co3 <- climate_co2[climate_co2$year > 2009 & climate_co2$year < 2014,]

ggplot(data=climate_co3, aes(x=Date, y=PDSI)) +
  geom_area(color = 'cyan4') +
  theme(panel.background = element_rect(), axis.text.x = element_text(size=6, angle=45)) +
  xlab("Date") +
  ylab("Palmer Drought Severity Index (PDSI)") +
  scale_y_continuous(breaks=c(-6, -4, -2, 0, 2, 4)) 
```
**Figure 3. PDSI ratings each months from 2010 until the end of 2013 show mostly negative PDSI ratings.** 
\
\

**PDSI and SP12**
\
Figure 4 investigates the relationship between the PDSI and the Standard Precipitation Index of 12 months from 1948 until 2014. In general, as the Standard Precipitation Index of 12 (the measure of how likely a dry spell or wet spell is in 12 months) increases, so does the Palmer Drought Severity Index. Figure 4 shows that if there is a low Standard Precipitation Index for a given measurement, it indicates a dry spell and a very low chance of precipiation. At the same time, the Palmer Drought Severity Index is negative, indicating a dry spell as well. In the time leading up to the big flooding event, the Palmer Drought Severity Index was consistently negative, which may suggest a low SP12 as well, which would make the flooding event appear to be a rare occurrence and within realm of a 1 in 1000 year flooding event. 
\
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}
ggplot(data=climate_co, aes(x=SP12, y=PDSI)) +
  geom_jitter(color = 'blueviolet') +
  theme(panel.background = element_rect()) +
  xlab("Standard Precipitation Index (12 Months)") +
  ylab("Palmer Drought Severity Index (PDSI)") +
  scale_y_continuous(breaks=c(-6, -4, -2, 0, 2, 4)) 
```
**Figure 4. PDSI increases as the SP12 increases** 
\
\

**Palmer "Z" Indexes throughout 2013**
\
Figure 5 investigates the Palmer "Z" Index over the course of 2013. A monthly "moisture anomoly" index helps explain how abnormal the moisture conditions are for a given month. In the case of 2013, Colorado experienced 6 where there was a negative moisture anomoly index. However, near the time of the flood and during the extreme flooding event, there was a very large ZNDX index, suggesting that the moisture value for that month was not only abnormal, but deviated from the neutral moisture anomoly rating. 
\
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}
ZNDXyear <- climate_co[265:276, "ZNDX"]
barplot(ZNDXyear, ylab="ZNDX", xlab = "2013", col="aquamarine4")

```
**Figure 5. Palmer "Z" Indexes throughout 2013 show mostly negative indices except for the September flooding event**
\
\

**Stream Discharge Before The Big One**
\
Figure 6 investigates the temporal relationship with stream dicharge in the three years leading up to the Colorado flooding event. From 2010 until 2013, stream discharge was cyclical, with peak stream discharges occurring around June each year. They seem to be at a minimum in June of 2012, and then there is a massive spike when the flooding event occurs in 2013. Cyclical stream discharge suggests that the flooding event was extremely unusual. 
\
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}
discharge <- read.csv("data/06730200-Discharge_Daily_1986-2013.csv")
discharge$date <- as.Date(discharge$datetime, format="%m/%d/%y")
discharge$dism <- discharge$disValue * 0.0283
dislab <- expression(Stream~Discharge~~(m^3~s^-1))
dis2 <- discharge[discharge$date > as.Date("20100101", format="%Y%m%d") & discharge$date < as.Date("20140101", format="%Y%m%d"),]

ggplot(data=dis2, aes(x= date, y=disValue)) +
  geom_line(color="violetred4") +
  xlab("Date") +
  ylab(dislab) +
  scale_x_date(date_labels="%b %Y")

```