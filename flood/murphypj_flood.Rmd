---
title: "Flood Assignment"
author: "PJ Murphy"
date: "4/2/2018"
output: 
  word_document:
    reference_docx: manuscriptstyle.docx
---

```{r setup, include=FALSE}
library(magicaxis)
```


While the flood seen in 2013 in the Boulder County of Colorado was of a huge magnitude, Figure 1 shows that this is not the first time that a rainfall event like this has happened, as large values of precipitation are seen in the 1960s and 1980s. The frequency of very large rain events was greater during the span of of 1950-1970 when compared to the 1990s and 2000s, which could be a result of climate change in the area. 

```{r plot 1, echo=FALSE}
precip <- read.csv("data/805333-precip_daily_1948-2013.csv")
precip$DateTime <- as.POSIXct(precip$DATE,format= "%Y%m%d %H:%M")
precip$HPCP[precip$HPCP==999.99] <- NA
plot(HPCP~DateTime, data=precip, type="l", xlab= "Year", 
     ylab= "Precipitation (mm)")
```
*Figure 1* Precipitation (mm) in Boulder County, Colorado over a span of 65 years.

Looking back approximately 10 years prior to the flooding in Figure 2, it is seen that this flood in September 2013 was twice as large as any rainfall event in Boulder county. Every year seems to have at least one major rainfall event, with the exception of 2005 and 2006, yet the number of September 2013 is anamolous in this data set.  

```{r plot 2, echo=FALSE}
startdate <- as.POSIXct("2003-09-01 01:00:00", 
                        "%Y-%m-%d %H:%M:%S", tz="UTC")
newrain <- precip[precip$DateTime > startdate,]
plot(HPCP ~ DateTime, data=newrain, type="l", xlab="Year", 
     ylab="Precipitation (mm)")
```
*Figure 2* Precipitation data from the 10 years leading up to the flood in 2013 in Boulder County. 


Figure 3 shows that large rainfall events often follow  major droughts. Also, droughts can often dry out soils and decreasing their absorbtivity and increasing the chance of flooding. The dry soil caused by the drought in combination with the large amount of precipitation are two factors that contributed to the massive flooding in Boulder county. Also, it should be noted that the area did not recover from the drought in early 2013 until 2015, even though there was a massive amount of rainfall in September of 2013.  

```{r plot 3, echo=FALSE}
clim_bc <- read.table("climate_co.txt", header=TRUE)
clim_bc$Date <- paste(clim_bc$YearMonth, "01", sep="")
clim_bc$Date <- as.Date(clim_bc$Date, format="%Y%m%d")
plot(PDSI ~ Date, data=clim_bc, type="l", xlab="Year", ylab= "Palmer Drought Severity Index")
```
*Figure 3* Over two decades of Palmer Drought Index values for Boulder County, Colorado. 


The Palmer Z index values in Figure 4 show much variability in the drought conditions for 20 years in Boulder County. The Z index is different from the the normal PDSI because it looks at drought conditions every month separately, not taking into account the conditions of previous months. This allows for the identification of wet periods during drier months or dry times during rainy periods. The separation of data for Z indexes results in the large variation seen month to month. Thus, the Z-indexes for the months following the drought of 2013, return to close to 0 much quicker than in Figure 3. However, the Z index does not give an accurate representation of the drought conditions over a long period of time.  

```{r plot 4, echo=FALSE}
clim_bc <- read.table("climate_co.txt", header=TRUE)
clim_bc$Date <- paste(clim_bc$YearMonth, "01", sep="")
clim_bc$Date <- as.Date(clim_bc$Date, format="%Y%m%d")
plot(ZNDX ~ Date, data=clim_bc, type="l", xlab="Year", ylab="Palmer Z-index")
```
*Figure 4* Palmer Z index history since the early 1990s in Boulder County. 

Figure 5 shows that during the flood, stream discharge increased very significantly. This is understandable as the more it rains, the more water there will be moving through streams and such. 

```{r plot 5, echo=FALSE}
discharge <- read.csv("data/06730200-Discharge_Daily_1986-2013.csv")

discharge$disCorrect <- discharge$disValue*0.0283168
discharge$Date <- as.Date(discharge$datetime, format= "%m/%d/%y")
dislab=expression(Stream~Discharge~~(m^3/s))

seqdisdates <- seq(min(discharge$Date), max(discharge$Date), length.out=10)

par(mar=c(5,5,1,1))
plot(disCorrect~Date, data=discharge, type="l", axes=FALSE, xlab="Year",
     ylab=dislab)
axis.Date(1, at=seqdisdates, cex.axis=0.9)
axis(2, las=2, cex.axis=0.9)
box()
```
*Figure 5* Stream discharge (cubic feet/ second) over 27 years in Boulder County, Colorado. 
