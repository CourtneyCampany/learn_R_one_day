---
title: "Colorado_Flood_Assignment"
author: "Alex Russell"
date: "3/27/18"
output:
  word_document:
    reference_docx: manuscriptstyle.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r figure 1, echo=FALSE, message=FALSE, warning=FALSE, summary=FALSE}
rain <- read.csv("data/rain_co.csv")
rain$DateTime <- as.POSIXct(rain$DATE, format="%Y%m%d %H:%M")
str(rain$DateTime)
range(rain$HPCP)
rain$HPCP[rain$HPCP==999.99] <- NA
write.csv(rain, "data/rain_co.csv", row.names=FALSE)
library(lubridate)
rain$month <- month(rain$DateTime)
se <- function(x) sd(x)/sqrt(length(x))
newrain <- rain[complete.cases(rain$HPCP),]
rain_agg <- doBy::summaryBy(HPCP ~ month, data=newrain,FUN=c(mean,se))
seqraindates <- seq(min(rain$DateTime), max(rain$DateTime), length.out=10)
seqraindates2 <- seq(min(rain$DateTime), max(rain$DateTime), by = "10 years")
plot(HPCP ~ DateTime, data=newrain, type="l",xlab="Year",ylab="Daily Precipitation (mm)",xaxt="n")
axis.POSIXct(1, at=seqraindates2)
```

Figure 1. Average Daily Precipitation by Year in Boulder Colorado since 1948, data retrieved from NOAA. 
/
/
Looking across the data collected in the region since 1948, there have been a couple of years in the past which resemble the year of 2013 where daily precipitation levels were just as high if not higher than the 2013 flood rates, namely the years 1960, 1970 and 1984 (Figure 1).  While this is the case the last large spike similar to that which occured in 2013 had not happened since 1984 and were not preceeded by several years of low precipitation like what occured in the case of the 2013 Colorado flood event. Regardless having a closer look at the years immediately preeceeding the 2013 flood event will be helpful in further pinpointing the climactic pressures at play leading to the "1 in 1000 year flood."

```{r figure 2,echo=FALSE, message=FALSE, warning=FALSE, summary=FALSE}
plot(HPCP.mean ~ month, data=rain_agg, xaxt='n', xlab="Month",ylab="Mean Precipitation (mm)")
with(rain_agg, arrows(month, HPCP.mean, month, HPCP.mean+HPCP.se, angle=90,
                      length=0.03))
with(rain_agg, arrows(month, HPCP.mean, month, HPCP.mean-HPCP.se, angle=90,
                      length=0.03))
monthaxis <- c("Jan", "Feb", "Mar", "Apr", "May", "June", "July", "Aug", "Sept",
               "Oct", "Nov", "Dec")
axis(1, at=1:12, labels=monthaxis, las=3)
```
Figure 2. Aggregate mean precipitation per month collected and integrated between 1948 and 2013 from Boulder, Colorado from NOAA data. 
/
/
Seasonally precipitqtion levels on average were highest over the summer months between June and into September (Figure 2). This is indicatve of the times of year when chances of floods are the highest. The Colorado flood of 2013 occured in September which is relatively late in Colorado's setandard rainy season. The fact that there was not as much rain preceeding the events of the 2013 flood exacerbated the effects of the flood given the top soil from years of drought made the soil surfaces to near impermeable levels allowing for more water runoff and less absorption to take place.
```{r figure 3, echo=FALSE, message=FALSE, warning=FALSE, summary=FALSE}
climate <- read.csv("data/climate_co.csv")
climate$year <- strptime(as.character(climate$YearMonth), "%Y%m")
climate$year2 <- format(climate$year, "%Y")
                         
climate$year4 <- month(climate$YearMonth)

pdsicols <- c("incipient drought", "mild drought", "moderate drought",
              "severe drought", "extreme drought","incipient flood", "mild flood",
              "moderate flood", "severe flood", "extreme flood" )
seqclimdates <- seq(min(climate$YearMonth), max(climate$YearMonth), length.out=2)
# seqclimdates2 <- seq(min(climate$YearMonth), max(climate$YearMonth), by ="2 years")

plot(PDSI ~ year4, data=climate, type="l", xlab="Date (YYYYMM)", ylab="Palmer Drought Severity Index")

```
Figure 3. Palmer Drought Severity Index(PDSI) by Date. PDSI values 0 to -.5 = normal; -0.5 to -1.0 = incipient drought; -1.0 to -2.0 = mild drought; -2.0 to -3.0 = moderate drought; -3.0 to -4.0 = severe drought; and greater than - 4.0 = extreme drought. Similar adjectives are attached to positive values for wet, flood spells.
/
/
In the months leading up to the 2013 flood event in Boulder, Colorado, the city had dropped to a PDSI of nearly -7 of severe drought conditions. Due to this, the rain that came in september could not be absorbed in fast enough rates due to how dry the top soil had become over the summer months with little to no rainfall. 

```{r figure 4, echo=FALSE, message=FALSE, warning=FALSE, summary=FALSE}
plot(PDSI ~ ZNDX, data=climate, xlab="Moisture Anomaly Index", ylab="Palmer Drought Severity Index")

```
Figure 4. Palmer Drought Severity Index(PDSI) by Moisture Anomaly Index (ZNDX). PDSI values 0 to -.5 = normal; -0.5 to -1.0 = incipient drought; -1.0 to -2.0 = mild drought; -2.0 to -3.0 = moderate drought; -3.0 to -4.0 = severe drought; and greater than - 4.0 = extreme drought. Similar adjectives are attached to positive values for wet, flood spells. Moisturn anomaly values indicate deviation from expected value for moisture per month. 
/
/
For the most part the relationship between PDSI and ZNDX is quite linear but for the year of 2013 one can see the drastic differences between values over the course of the 2013 year. (Note: I spent hours trying to figure out how to highlight 2013 data but couldn't get anything to work - I can show you my code later but this graph really wasn't made from lack of trying, If you can't tell R is not my forte)

```{r figure 5, echo=FALSE, message=FALSE, warning=FALSE, summary=FALSE}
discharge <- read.csv("data/discharge_co.csv")
###need the conversion
recentdis <- discharge[discharge$Date >="2008-09-01", c("Date", "disvalue_m")]
plot(disvalue_m ~ Date, data=discharge, ylab="Discharge Value (m)", 
     xlab= "Date (YYYY-MM-DD)", type="l")

```
Figure 5. Discharge value versus Date. 
/
/
From the data one can see a spike occured in discharge in the later months of 2013 with none of  equivalent value since 2003. 


