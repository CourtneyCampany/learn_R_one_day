---
title: "Trees"
author: "Karl Brown"
date: "2/13/2018"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r package downloads and more,echo=FALSE}
library(plotrix)
library(magicaxis)
library(scales)

trees <- read.csv("tree_allometry.csv")

mycols=c("red","gold","chartreuse","cornflowerblue")
mycols2=alpha(mycols,.4)
pftnames=c("Deciduous Angiosperm","Deciduous Gymnosperm","Evergreen Angiosperm","Evergreen Gymnosperm")
treemass=log10(trees$m.to)

```

```{r graph 1, echo=FALSE}

hmreg=lm(log10(trees$h.t)~log10(trees$m.to))
summary(hmreg)
plot(log10(trees$h.t)~log10(trees$m.to),axes=FALSE,col=mycols2[trees$pft],pch=16,xlab="Total Plant Mass (kg)",ylab="Plant Height (m)")
magaxis(side=1,unlog=1,frame.plot=TRUE)
magaxis(side=2,unlog=1,frame.plot=TRUE)
ablineclip(hmreg,x1=min(log10(trees$m.to),na.rm=TRUE),x2=max(log10(trees$m.to),na.rm=TRUE),lwd=3)
legend("topleft", levels(trees$pft),col=mycols,legend=pftnames,pch=16,cex=.65)


```

**Figure 1** Plant height vs. total plant mass. In humans there is a clear relationship between height and mass, thus exploring this relationship in trees was of initial interest. There is a clear relationship between these two (p<0.01). More interesting is that this is not specific to any specific plant functional type, but it is a relationship that is conserved across all plant functional types. 


```{r graph 2, echo=FALSE}

mareg=lm(trees$m.so~trees$age)
summary(mareg)
plot(trees$m.so~trees$age,col=mycols2[trees$pft],pch=16,xlab="Plant Age (yrs)",ylab="Above Ground Mass (kg)",cex=2)
ablineclip(mareg,x1=min(trees$age,na.rm=TRUE),x2=max(trees$age,na.rm=TRUE),lwd=3)
legend("topleft", levels(trees$pft),col=mycols,legend=pftnames,pch=16,cex=.65)

```

**Figure 2** Above ground mass vs. plant age. This relationship of age and mass was one that was to be expected, but a closer analysis of the data and plot reveals that there are several outlier plants that are a great deal older than the rest of the trees. More interesting is that all of the outlier plants are of the evergreen gymnosperm functional type. Perhaps a closer look at the data within each plant functional type would reveal more surprising results, but the data as a whole show that above ground mass increases with age of the plant. 


```{r graph 3, echo=FALSE}

lmsmreg=lm(trees$m.lf~trees$m.st)
summary(lmsmreg)
plot(trees$m.lf~trees$m.st,col=mycols2[trees$pft],pch=16,xlab="Mass of Plant Stem (kg)",ylab="Mass of Leaves (kg)",cex=2)
ablineclip(lmsmreg,x1=min(trees$m.st,na.rm=TRUE),x2=max(trees$m.st,na.rm=TRUE),lwd=3)
legend("bottomright", levels(trees$pft),col=mycols,legend=pftnames,pch=16,cex=.65)


```

**Figure 3** Mass of leaves vs. mass of plant stem. This relationship between leaf mass and plant stem mass was expected as the larger trees would theoretically have more leaves. But, what stood out about this graph is that both evergreen angiosperms and evergreen gymnosperms had markedly higher masses in both categories. This can perhaps be explained by the previous graph which showed how evergreens lived to be older, thus their mass is able to grow to very high numbers. 


```{r graph 4,echo=FALSE}

trees2<-droplevels(trees[complete.cases(trees$m.lf),])
trees3<-droplevels(trees[complete.cases(trees$m.lf)&complete.cases(trees$m.to),])
trees3$LMF<-trees3$m.lf/trees3$m.to

treemass=log10(trees3$m.to)

lmfreg=lm(trees3$LMF~treemass)
plot(trees3$LMF~treemass,axes=FALSE,col=mycols2[trees3$pft],pch=16,xlab="Total Plant Mass (kg)",ylab="Leaf Mass Fraction (kg/kg)")
magaxis(side=1,unlog=1,frame.plot=TRUE)
axis(2)
ablineclip(lmfreg,x1=min(treemass,na.rm=TRUE),x2=max(treemass,na.rm=TRUE),lwd=4)
legend("topright", levels(trees3$pft),col=mycols,legend=pftnames,pch=16,cex=.65)


```

**Figure 4** Leaf mass fraction vs. total plant mass. This figure shows how as plants grow larger and gain more mass, they less mass is found in the leaves. There is a general negative relationship between the two variables with said relationship being conserved across all plant functional types. The next step in this investigation is to determine where the mass is shifting to as plants gain more mass. 

```{r graph 5,echo=FALSE}

trees2<-droplevels(trees[complete.cases(trees$m.st),])
trees3<-droplevels(trees[complete.cases(trees$m.st)&complete.cases(trees$m.to),])
trees3$SMF<-trees3$m.st/trees3$m.to

smfreg=lm(trees3$SMF~log10(trees3$m.to))
plot(trees3$SMF~log10(trees3$m.to),axes=FALSE,col=mycols2[trees3$pft],pch=16,xlab="Total Plant Mass (kg)",ylab="Stem Mass Fraction (kg/kg)")
magaxis(side=1,unlog=1,frame.plot=TRUE)
axis(2)
ablineclip(smfreg,x1=min(treemass,na.rm=TRUE),x2=max(treemass,na.rm=TRUE),lwd=4)
legend("topleft", levels(trees3$pft),col=mycols,legend=pftnames,pch=16,cex=.65)

```

**Figure 5** Stem mass fraction vs. total plant mass. This figure shows that as plant mass increases, the amount of mass stored in the stem of the plant increases. This is a phenomenon that is expected as noted by multiple authors and studies. From the figure it is clear that all plant functional types tend to have their own range of mass, for example evergreen gymnosperms tend to have the most mass. But the trend of increasing stem mass fraction with increasing total plant mass can be observed across plant functional types. 


